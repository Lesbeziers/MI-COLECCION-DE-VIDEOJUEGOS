<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mi Colección de Videojuegos</title>
    <link rel="stylesheet" href="assets/css/global.css">
</head>
<body>

  <!-- Icono placeholder del mando -->
  <div class="hero-icon"></div>

  <!-- Título principal -->
  <h1>MI COLECCIÓN<br>DE VIDEOJUEGOS</h1>

  <!-- Bloque de estadísticas -->
  <div class="stats">

    <a href="plataformas.html" class="stat-block" style="text-decoration:none; color:inherit;">
      <div class="stat-circle"></div>
      <div class="stat-label">PLATAFORMAS</div>
      <div class="stat-value"><span id="platform-count">X</span></div>
    </a>

    <!-- COLECCIÓN ahora es clicable -->
    <a href="coleccion.html" class="stat-block" style="text-decoration:none; color:inherit;">
      <div class="stat-circle"></div>
      <div class="stat-label"><strong>COLECCIÓN</strong></div>
      <div class="stat-value"><span id="collection-count">...</span></div>
    </a>

  </div>

  <!-- Bloque de búsqueda -->
  <div class="search-section">

    <div class="search-label">BÚSQUEDA</div>

    <div class="search-box">
      <input type="text" placeholder="Buscar en mi colección..." />
    </div>
  </div>
  <div class="footer-note">LesBeziers, 2025</div>

<script>
document.addEventListener("DOMContentLoaded", async () => {

    // Elemento donde pondremos el número
    const countEl = document.getElementById("platform-count");
    if (!countEl) return;
  
    const applyPressHandlers = (elements) => {
        elements.forEach(el => {
            const setPressed = () => el.classList.add("is-pressed");
            const clearPressed = () => {
                el.classList.remove("is-pressed");
                el.blur();
            };

            el.addEventListener("pointerdown", setPressed);
            ["pointerup", "pointerleave", "pointercancel", "lostpointercapture", "blur"].forEach(evt => {
                el.addEventListener(evt, clearPressed);
            });
        });
    };

    applyPressHandlers(document.querySelectorAll(".stat-block"));

    try {
        // Cargar plataformas.html como texto
        const resp = await fetch("plataformas.html");
        const html = await resp.text();

        // Crear DOM temporal para analizarlo
        const temp = document.createElement("div");
        temp.innerHTML = html;

        // Contar TODOS los iconos de plataformas
        const total = temp.querySelectorAll(".platform-card").length;

        // Pintar el número real
        countEl.textContent = total;

    } catch (err) {
        console.error("Error contando plataformas:", err);
    }

// Cargar suma de colección desde Google Sheets (SOLO celda B50)
try {
    const collectionEl = document.getElementById("collection-count");
    if (collectionEl) {
        // Añadimos &range=B50 para descargar SOLO esa celda
        const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQbmbDObrrqQMmeAM2zMIYNzMFRW8Hqf3_lEfmQh-K1carYW-Q7s66Wvum2XEepYJMVaJGswnUuxG4w/pub?gid=1807643027&single=true&output=csv&range=B50";
        const resp = await fetch(csvUrl);
        const text = await resp.text();
        
        // El CSV solo contendrá el valor de B50
        const num = parseInt(text.trim(), 10);
        if (!isNaN(num)) {
            collectionEl.textContent = num.toLocaleString("es-ES");
        }
    }
} catch (err) {
    console.error("Error cargando suma colección:", err);
}
});
</script>

  
</body>

</html>
